네, 알겠습니다. 아주 좋은 지적입니다. 제가 앞서 나갔네요.

'소울 캔버스'라는 복잡한 개념은 아직 존재하지 않고, 오직 **'신비한 타로 월드'를 만들었던 단순한 '붕어빵틀 v1.0'만 가지고 있는 상황**을 기준으로 다시 설명해 드리겠습니다.

이것이 훨씬 더 현실적인 시나리오입니다.

---

### **'타로 월드 v2.0' 기능 업그레이드 구현 계획 (v1.0 붕어빵틀 기반)**

#### **핵심 전략: 우리의 '단순한 붕어빵틀'을 '고급 레스토랑'으로 리모델링하기**

지금 우리가 가진 것은 '팥붕어빵'(타로 월드)을 만들 수 있는 단순한 틀뿐입니다. 이제 이 틀을 대대적으로 업그레이드해서, 수십 가지의 프리미엄 요리(세분화된 질문)를 제공하는 고급 레스토랑으로 만드는 과정입니다.

---

### **Phase 1: 백엔드 확장 - '단순 메뉴판'을 '프리미엄 카탈로그'로**

**1. 데이터베이스(DB) 스키마 확장 및 신규 생성:**

*   **`AppMenu` 테이블 확장:**
    *   기존 테이블(`appId`, `title`, `category`, `uiType`)에 새로운 정보를 담을 컬럼들을 추가합니다.
    *   **`isFree` (BOOLEAN):** 이 메뉴가 무료인지 여부.
    *   **`requiredCoins` (INT):** 유료일 경우 필요한 코인 개수.
    *   **`description` (TEXT):** 질문에 대한 간단한 설명.
    *   **`spreadType` (VARCHAR):** 어떤 카드 배열법을 쓰는지 식별하는 값. (예: 'single_card', 'celtic_cross')

*   **신규 테이블 생성 (핵심 기능 추가):**
    *   **`User` 테이블:** 사용자 계정을 관리하기 위해 새로 만듭니다. 처음에는 간단하게 시작합니다.
        *   `id`, `username`, **`coinBalance` (INT)**.
    *   **`ReadingHistory` 테이블:** 사용자가 본 타로 결과를 저장하기 위해 새로 만듭니다.
        *   `id`, `userId`, `menuId` (어떤 질문이었는지), `resultData` (JSON: 카드 배열 및 해석), `createdAt`.

**2. '타로 월드 v2.0' 데이터(레시피) 대규모 업데이트 (SQL DML):**

*   '타로 월드' 앱(`appId: 1`)의 기존 메뉴 데이터를 모두 지우고, 경쟁 앱처럼 세분화된 질문 목록으로 교체합니다.

    ```sql
    -- '타로 월드'의 기존 메뉴(3개) 삭제
    DELETE FROM AppMenu WHERE appId = 1;

    -- 새로운 메뉴(질문) 데이터 추가
    -- 무료 콘텐츠 예시
    INSERT INTO AppMenu (appId, title, category, uiType, spreadType, isFree, requiredCoins) VALUES
    (1, '오늘의 타로 운세', 'tarot_page', 'show_result', 'single_card', TRUE, 0);

    -- 유료 콘텐츠 예시
    INSERT INTO AppMenu (appId, title, category, uiType, spreadType, isFree, requiredCoins) VALUES
    (1, '헤어진 그 사람과 재회 가능성', 'tarot_page', 'show_result', 'celtic_cross', FALSE, 10),
    (1, '이 사람, 내 운명일까?', 'tarot_page', 'show_result', 'three_card_spread', FALSE, 5);
    -- ... 수십 개의 질문을 이런 식으로 추가 ...
    ```
    *   `category: 'tarot_page'`는 클라이언트에게 "타로 리딩 플로우를 시작해!"라고 알려주는 신호입니다.

**3. API 설계 (기존 API 확장 및 신규 추가):**

*   **`GET /app-config` 확장:**
    *   응답하는 `menus` 객체에 새로 추가된 `isFree`, `requiredCoins` 등 모든 필드를 포함시킵니다.
    *   로그인한 사용자의 `coinBalance`도 함께 내려줍니다.

*   **신규 API:**
    *   **`POST /tarot/read` (핵심 로직):** 사용자가 유료 질문(`menuId`)을 요청했을 때 호출됩니다.
        1.  사용자의 코인이 충분한지 확인합니다.
        2.  코인을 차감합니다.
        3.  해당 질문의 `spreadType`에 맞는 로직으로 카드를 뽑아 **결과 데이터를 생성**합니다.
        4.  결과를 `ReadingHistory`에 저장합니다.
        5.  클라이언트에게 **최종 결과 데이터와 남은 코인**을 응답으로 보내줍니다.
    *   `POST /user/watch-ad`: 광고 시청 완료 시 코인을 충전해주는 API.
    *   `GET /user/reading-history`: 과거 타로 결과 목록을 조회하는 API.

---

### **Phase 2 & 3: Flutter 클라이언트('붕어빵틀') 대규모 리모델링**

**1. 프로젝트 구조 변경 및 화면 신설:**

*   **메인 화면 교체:** 기존 `MainScreen`(하단 탭 메뉴 방식)을 **`QuestionListScreen.dart`**로 교체합니다. 이 화면이 이제 앱의 첫 화면이 됩니다.
    *   이 화면은 서버에서 받은 메뉴 목록을 기반으로 **세분화된 질문 리스트**를 보여줍니다.
    *   각 항목에는 **[무료]** 또는 **[코인 O개]** 태그를 표시합니다.

*   **신규 화면 추가:**
    *   **`CardSelectionScreen.dart`:** 카드 셔플 애니메이션과 카드 선택 UI만 담당하는 화면. (기존 `TarotReadingScreen`에서 UI 부분만 분리)
    *   **`ResultScreen.dart`:** 서버로부터 받은 최종 결과 데이터를 예쁘게 보여주는 화면.
    *   **`MyHistoryScreen.dart`:** 나의 과거 타로 결과 목록을 보여주는 화면.
    *   **`CoinShopScreen.dart`:** 광고 시청, 인앱 결제로 코인을 충전하는 화면.

**2. 기능 구현 및 플로우 재구성:**

*   **사용자 인증(로그인) 기능 추가:** 앱이 시작될 때 간단한 로그인 절차를 추가하여 `User`를 식별합니다.
*   **인앱 재화(코인) 시스템 구현:** 화면 상단에 항상 코인 보유량을 표시하고, `CoinShopScreen`에서 충전 기능을 구현합니다.
*   **완전히 새로운 타로 리딩 플로우:**
    1.  **`QuestionListScreen`**에서 질문 선택.
    2.  (유료일 경우) 코인 사용 확인 팝업 -> **`POST /tarot/read` API 호출**.
    3.  (API 응답이 오기 전) **`CardSelectionScreen`**으로 이동하여 셔플 애니메이션과 카드 선택 진행.
    4.  (카드를 모두 선택하면) 이전에 호출했던 **`/tarot/read` API의 응답 결과**를 **`ResultScreen`**에 전달하여 표시.

*   **결과 저장/보기 기능:**
    *   `MyHistoryScreen`에서 `GET /user/reading-history` API를 호출하여 결과 목록을 보여줍니다.
    *   목록에서 항목을 선택하면, 저장된 `resultData`를 `ResultScreen`으로 보내 다시 보여줍니다.

---

### **결론: v1.0에서 v2.0으로의 진화**

이 계획은 '신비한 타로 월드'라는 단순한 앱을, **본격적인 수익 모델과 사용자 유지 기능을 갖춘 서비스**로 탈바꿈시키는 과정입니다.

*   **DB/API:** 단순 콘텐츠 나열에서, **사용자별 데이터(코인, 히스토리)를 관리하는 시스템**으로 발전합니다.
*   **Flutter:** 정적인 화면 몇 개로 구성된 구조에서, **여러 화면이 유기적으로 데이터를 주고받는 복잡한 플로우**를 가진 앱으로 발전합니다.

이 대규모 업그레이드가 성공적으로 끝나면, 우리의 **'붕어빵틀'은 이제 v2.0**이 됩니다. 이 틀은 단순한 운세 앱뿐만 아니라, 프리미엄 콘텐츠를 판매하고 사용자 데이터를 관리하는 훨씬 더 정교하고 강력한 앱들을 만들어낼 수 있는 기반이 됩니다.